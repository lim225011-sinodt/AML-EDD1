# AML300数据库建表和数据生成执行指南

## 📋 执行概述

本指南详细说明如何执行AML300数据库的完整建表和数据生成流程。

## 🎯 数据规模目标

### 客户数据
- **个人客户**: 1,000个
- **企业客户**: 100个
- **高风险个人客户**: 100个
- **高风险企业客户**: 10个

### 交易数据
- **总交易笔数**: 10,000笔
- **交易时间范围**: 2020年1月1日 - 2020年6月30日 (6个月)
- **账户数量**: 约1,200个

### 业务数据
- **银行网点**: 20个
- **大额交易报告**: 约300份
- **可疑交易报告**: 约150份
- **跨境交易**: 约500笔
- **联网核查记录**: 约1,100条

## 📁 脚本文件说明

| 文件名 | 功能描述 | 执行顺序 |
|--------|---------|---------|
| `01_create_database_tables.sql` | 创建15张数据库表结构 | 第1步 |
| `02_generate_mock_data.sql` | 生成基础客户数据(个人+企业) | 第2步 |
| `02b_generate_additional_data.sql` | 生成账户、交易、风险评估数据 | 第3步 |
| `02c_generate_remaining_data.sql` | 生成报告、跨境交易等其他数据 | 第4步 |
| `03_data_validation.sql` | 数据质量验证和合规性检查 | 第5步 |

## 🚀 执行步骤

### 前置条件

1. **数据库环境**: MySQL 8.0+
2. **字符集**: UTF-8MB4
3. **存储空间**: 至少2GB可用空间
4. **权限**: 数据库管理员权限

### 详细执行流程

#### 步骤1: 连接数据库

```bash
# 命令行连接方式
mysql -h 101.42.102.9 -P 3306 -u root -p

# 或使用MySQL客户端工具连接
# 主机: 101.42.102.9
# 端口: 3306
# 用户: root
# 密码: Bancstone123!
```

#### 步骤2: 创建数据库

```sql
-- 如果数据库不存在则创建
CREATE DATABASE IF NOT EXISTS AML300
CHARACTER SET utf8mb4
COLLATE utf8mb4_unicode_ci;

-- 使用数据库
USE AML300;
```

#### 步骤3: 按顺序执行脚本

```sql
-- 第1步: 创建表结构
SOURCE 01_create_database_tables.sql;

-- 第2步: 生成基础客户数据
SOURCE 02_generate_mock_data.sql;

-- 第3步: 生成账户和交易数据
SOURCE 02b_generate_additional_data.sql;

-- 第4步: 生成剩余业务数据
SOURCE 02c_generate_remaining_data.sql;

-- 第5步: 数据质量验证
SOURCE 03_data_validation.sql;
```

## ⏱️ 执行时间预估

| 脚本 | 预估执行时间 | 说明 |
|------|-------------|------|
| `01_create_database_tables.sql` | 1-2分钟 | 创建15张表结构 |
| `02_generate_mock_data.sql` | 3-5分钟 | 生成1100个客户基础数据 |
| `02b_generate_additional_data.sql` | 5-10分钟 | 生成账户和10000笔交易 |
| `02c_generate_remaining_data.sql` | 3-5分钟 | 生成报告和其他业务数据 |
| `03_data_validation.sql` | 2-3分钟 | 数据质量验证 |
| **总计** | **15-25分钟** | 完整流程 |

## 📊 预期结果

### 数据量统计

执行完成后，您应该看到类似以下的数据统计：

```
=== AML300数据库数据生成完成统计 ===
个人客户数量: 1000
企业客户数量: 100
银行网点数量: 20
账户数量: 1200
交易记录数量: 10000
风险评估记录数量: 1000
大额交易报告数量: 300
可疑交易报告数量: 150
跨境交易记录数量: 500
联网核查记录数量: 1100
```

### 验证结果

数据验证脚本将输出详细的质量报告：

```
=== 数据质量总评分 ===
数据完整性    100    优秀
合规性        100    优秀
业务逻辑      100    优秀
总体评分      95     优秀
```

## 🔧 常见问题处理

### 问题1: 执行时间过长

**原因**: 大量数据插入导致性能下降
**解决方案**:
```sql
-- 在执行前设置
SET FOREIGN_KEY_CHECKS = 0;
SET UNIQUE_CHECKS = 0;
SET AUTOCOMMIT = 0;

-- 执行完成后恢复
SET FOREIGN_KEY_CHECKS = 1;
SET UNIQUE_CHECKS = 1;
SET AUTOCOMMIT = 1;
```

### 问题2: 字符编码错误

**原因**: 数据库字符集不支持中文
**解决方案**:
```sql
-- 确保使用UTF-8MB4
SET NAMES utf8mb4;
SET CHARACTER SET utf8mb4;
```

### 问题3: 磁盘空间不足

**原因**: 生成的数据量过大
**解决方案**:
- 清理不必要的表和数据
- 增加磁盘空间
- 调整数据生成参数

### 问题4: 权限不足

**原因**: 用户权限不够
**解决方案**:
```sql
-- 确保有足够权限
GRANT ALL PRIVILEGES ON AML300.* TO 'root'@'%';
FLUSH PRIVILEGES;
```

## ✅ 质量验证清单

执行完成后，请检查以下项目：

- [ ] 个人客户数量达到1000个
- [ ] 企业客户数量达到100个
- [ ] 账户数量达到1200个
- [ ] 交易记录数量达到10000笔
- [ ] 所有证件号码长度≥6位
- [ ] 所有账号格式正确(只含数字、字母、'-')
- [ ] 所有客户名称长度符合要求
- [ ] 所有交易日期在2020年1-6月范围内
- [ ] 不含特殊字符(?、！、$、%、^、*)
- [ ] 客户-账户-交易数据关联正确

## 📈 性能优化建议

1. **索引优化**: 脚本已自动创建必要的索引
2. **分区表**: 对于大数据量可考虑按时间分区
3. **查询优化**: 使用适当的WHERE条件和LIMIT
4. **定期维护**: 定期执行OPTIMIZE TABLE

## 🔄 重新执行流程

如需重新生成数据：

```sql
-- 删除现有数据
DROP DATABASE IF EXISTS AML300;

-- 重新执行完整流程
CREATE DATABASE AML300 CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE AML300;
-- 然后按顺序执行所有脚本
```

## 📞 技术支持

如执行过程中遇到问题：

1. 检查MySQL版本和配置
2. 确认字符集设置
3. 验证磁盘空间
4. 检查用户权限
5. 查看错误日志

---

**版本**: v1.0
**更新时间**: 2025年11月11日
**适用数据库**: MySQL 8.0+